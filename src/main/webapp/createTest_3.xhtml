<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://java.sun.com/jsp/jstl/core" >

    <h:head>
        <title>Création de test</title>
        <h:outputStylesheet name="style.css" library="css" /> 
    </h:head>

    <h:body>
        <script src="#{facesContext.externalContext.requestContextPath}/src-noconflict/ace.js" type="text/javascript"></script>

        <script>
            function submitData() {
                document.getElementById('form:hidden').value = editor.getSession().getValue();
            }
        </script>


        <div id="container">
            <ui:insert name="header" >
                <ui:include src="/templates/header.xhtml" />
            </ui:insert>



            <div id="content">
                <p:panel header="Création de test - page n°3"  style="height:auto;"> 

                    <h:form id="form" style="border:1px solid transparent;padding:0px;" enctype="multipart/form-data"> 

                        <p:panel style="width:auto;padding:20px;">  
                            <br/>
                            <h:outputText value="Question n°#{create3.count}" />    
                            <br/>
                            <br/>

                            <c:if test="#{create3.questionIsCreated eq 1}">

                                
                                
                            </c:if>
                            <c:if test="#{create3.questionIsCreated  eq 0}">
                                <h:outputText value="Saisissez l'énoncé de la question :" /> 
                                <br/>
                                <p:editor id="editor" value="#{create3.enonce}" style="width:580px;"/>  
                                <br/>
                                <br/>

                                <h:outputText value="Ajouter une image :" /> 
                                <p:fileUpload fileUploadListener="#{create3.handleFileUpload}" 
                                              mode="advanced" 
                                              dragDropSupport="false"  
                                              update="messages" 
                                              sizeLimit="100000" 
                                              fileLimit="3" 
                                              label="Selectionner"
                                              allowTypes="/(\.|\/)(gif|jpe?g|png)$/" />  
                                <p:growl id="messages" showDetail="true"/>  
                                <br/>
                                <h:commandButton id="Valider" class="btn" 
                                                 action="#{create3.creerQuestion}"
                                                 value="Créer la Question" />

                            </c:if>
                            <br/>
                            <hr/>
                            <br/>

                            <h:outputText value="Selectionner une rubrique: " /> 
                            <h:selectOneMenu value="#{create3.nomRubrique}">
                                <f:selectItems value="#{create3.listRubrique}" var="rub" itemValue="#{rub.rubriqueid}" itemLabel="#{rub.rubriquenom}"/>
                            </h:selectOneMenu>  

                            <br/><br/><br/>

                            <p:fieldset legend="Saisissez une proposition" style="width:500px;padding:20px;border:1px solid silver;float:left;margin-top:20px;">  
                                <p:panelGrid columns="1" >
                                    <p:inputTextarea value="#{create3.theProposition}" rows="3" cols="77" />  
                                    <p:panelGrid columns="2" > 
                                        <h:outputText value="La proposition est-elle : vraie ? " />  
                                        <p:selectOneRadio id="check" value="#{create3.propositionEtat}">
                                            <f:selectItem itemValue="1" itemLabel="Vraie" />
                                            <f:selectItem itemValue="0" itemLabel="Fausse" />
                                        </p:selectOneRadio>
                                    </p:panelGrid>
                                </p:panelGrid>
                                <br/><br/>
                                <h:commandButton id="Valider" class="btn" 
                                                 action="#{create3.ajouterProposition}"
                                                 value="Ajouter la proposition" />
                            </p:fieldset>

                            <br/>
                            <hr style="margin-top:280px;"/>
                            <br/>


                            <h:dataTable value="#{create3.listProposition}" var="list" styleClass="order-table"
                                         headerClass="order-table-header"
                                         rowClasses="order-table-odd-row,order-table-even-row" 
                                         style="width:850px;margin-left:auto;margin-top:2px;margin-right:auto;"  >

                                <h:column>
                                    <f:facet name="header">Proposition(s)</f:facet>
                                    <h:outputText value="#{list.propositionlibelle}"/> 

                                </h:column>
                                <h:column>
                                    <f:facet name="header">La réponse est-elle vraie ?</f:facet>
                                    <h:outputText value="état : #{list.propositionvrai}"/> 
                                    <c:if test="#{list.propositionvrai eq 1}">
                                        <h:outputText value=" oui "/> 
                                    </c:if>
                                    <c:if test="#{list.propositionvrai eq 0}">
                                        <h:outputText value=" non "/> 
                                    </c:if>
                                </h:column>
                            </h:dataTable>
                            <br/>

                            <br/>


                            <c:if test="#{create3.type eq 1}"> <!--type code-->
                                <br/>
                                <h:outputText value="Saisissez une partie du code : " /> 
                                <br/>
                                <div id="editor_enonce" style="width:580px;height:250px;" name="editor_enonce" value="#{create3.code_enonce}">  </div>
                                <h:inputHidden id="hidden" value="#{create3.code_enonce}" />
                                <br/>
                                <!--    solarized_dark // cobalt -->
                                <script type="text/javascript">
                                    // <![CDATA[
                                    var editor = ace.edit("editor_enonce");
                                    editor.setTheme("ace/theme/cobalt");
                                    editor.getSession().setMode("ace/mode/php");
                                    document.getElementById('editor_enonce').style.fontSize = '15px';
                                    // ]]>
                                </script>
                            </c:if> 
                            <h:commandButton  class="btn" 
                                              action="#{create3.validerQuestion}"
                                              value="Valider la question" /><br />

                            <h:commandButton  class="btn" 
                                              action="#{create3.voirQuestion}"
                                              value="Voir toutes les questions" /><br />
                        </p:panel> 

                    </h:form>

                </p:panel>
            </div>

            <ui:insert name="footer" >
                <ui:include src="/templates/footer.xhtml" />
            </ui:insert>
        </div> <!-- container -->
    </h:body>
</html>     